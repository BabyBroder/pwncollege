#include <stdio.h>
#include <unistd.h>

char secrect_message[] = "Doan DUc Anh dep trai";

int main(int argc, char **argv)
{
    // leak secrect_message
    printf("secret_message is located at: %p\n", &secrect_message);

    // open a file
    FILE *file_pointer = fopen("/dev/null", "w");

    // overwrite the file struct from stdin
    read(0, file_pointer, 0x100);

    // call fwrite on the file
    char buf[256];
    puts("Calling fwrite\n");
    fwrite(buf, 1, 40, file_pointer);
    return 0;
}